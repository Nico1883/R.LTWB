## Outliers detection and processing throught statistical methods

* Processed file: [D:/R.LTWB/.datasets/IDEAM_EDA/Pivot_TMX_CON.csv](../IDEAM_EDA/Pivot_TMX_CON.csv)
* Execution date: 2022-11-05 08:36:05.547972
* Python version: 3.10.5 (tags/v3.10.5:f377153, Jun  6 2022, 16:14:13) [MSC v.1929 64 bit (AMD64)]
* Python path: ['D:\\R.LTWB\\.src', 'D:\\R.LTWB', 'D:\\R.TeachingResearchGuide', 'D:\\R.GISPython', 'D:\\R.HydroTools.wiki']
* matplotlib version: 3.6.0
* pandas version: 1.4.3
* numpy version: 1.23.2
* Stations exclude: ['28017140', '25027020', '25027410', '25027490', '25027330', '25027390', '25027630', '25027360', '25027320', '16067010', '25027420']
* Print table sample: True
* Instructions & script: https://github.com/rcfdtools/R.LTWB/tree/main/Section03/Outlier
* License: https://github.com/rcfdtools/R.LTWB/blob/main/LICENSE.md
* Credits: r.cfdtools@gmail.com


### General dataframe information with 15341 IDEAM records for 25 stations

Dataframe records head sample

| Fecha               |   15015020 |   15065040 |   23215060 |   25025002 |   25025090 |   25025250 |   25025300 |   25025330 |   28015030 |   28015070 |   28025020 |   28025040 |   28025070 |   28025080 |   28025090 |   28025502 |   28035010 |   28035020 |   28035040 |   28035070 |   28045020 |   28045040 |   29065010 |   29065020 |   29065030 |
|:--------------------|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|
| 1980-01-01 00:00:00 |       32.2 |        nan |        nan |        nan |       33.6 |        nan |        nan |        nan |      nan   |       32.4 |        nan |      nan   |       34.8 |        nan |        nan |        nan |        nan |       34.6 |        nan |        nan |        nan |        nan |        nan |        nan |       33.2 |
| 1980-01-02 00:00:00 |       32.6 |        nan |        nan |        nan |       33.4 |        nan |        nan |        nan |      nan   |       29.8 |        nan |       29.8 |       34   |        nan |        nan |        nan |        nan |       30.8 |        nan |        nan |        nan |        nan |        nan |        nan |       32.8 |
| 1980-01-03 00:00:00 |       33   |        nan |        nan |        nan |       33.8 |        nan |        nan |        nan |       34.3 |       32.4 |        nan |       30   |      nan   |         35 |        nan |        nan |        nan |       34.4 |        nan |        nan |        nan |        nan |        nan |        nan |       33.4 |

Dataframe records tail sample

| Fecha               |   15015020 |   15065040 |   23215060 |   25025002 |   25025090 |   25025250 |   25025300 |   25025330 |   28015030 |   28015070 |   28025020 |   28025040 |   28025070 |   28025080 |   28025090 |   28025502 |   28035010 |   28035020 |   28035040 |   28035070 |   28045020 |   28045040 |   29065010 |   29065020 |   29065030 |
|:--------------------|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|
| 2021-12-29 00:00:00 |        nan |        nan |        nan |       35.4 |       34.8 |       34.2 |       36.6 |       33.2 |        nan |       33.2 |       32.6 |        nan |       34.8 |        nan |       36   |        nan |       35.6 |       34.8 |       37.2 |        nan |        nan |        nan |        nan |       35.2 |        nan |
| 2021-12-30 00:00:00 |        nan |        nan |        nan |       34.4 |       35   |       34   |       37.2 |      nan   |        nan |       33.4 |       32.4 |        nan |       35.2 |        nan |       37   |        nan |       35   |       35   |       38   |        nan |        nan |        nan |        nan |       34.4 |        nan |
| 2021-12-31 00:00:00 |        nan |        nan |        nan |       34.8 |       34.6 |       35.6 |       38   |      nan   |        nan |       33.6 |       33.6 |        nan |       36.4 |        nan |       36.2 |        nan |       36.6 |       35   |       38.4 |        nan |        nan |        nan |        nan |       37.6 |        nan |

Datatypes for station and nulls values in the initial file

<div align="center">

|       | 15015020   | 15065040   | 23215060   | 25025002   | 25025090   | 25025250   | 25025300   | 25025330   | 28015030   | 28015070   | 28025020   | 28025040   | 28025070   | 28025080   | 28025090   | 28025502   | 28035010   | 28035020   | 28035040   | 28035070   | 28045020   | 28045040   | 29065010   | 29065020   | 29065030   |
|:------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|
| Dtype | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    |
| Nulls | 6482       | 11876      | 14381      | 7640       | 6855       | 3583       | 5275       | 7735       | 14214      | 2696       | 2375       | 12728      | 1943       | 8265       | 2388       | 3885       | 6899       | 3205       | 5917       | 15299      | 14291      | 14557      | 14448      | 5935       | 4804       |

</div>


<div align="center">

General statistics table - Initial file

</div>


<div align="center">

|          |   count |    mean |     std |   min |   25% |   50% |   75% |   max |
|---------:|--------:|--------:|--------:|------:|------:|------:|------:|------:|
| 15015020 |    8859 | 33.0729 | 1.48932 |  25.4 | 32.2  |  33.2 |  34.2 |  38.4 |
| 15065040 |    3465 | 34.0803 | 1.83791 |  25.1 | 33    |  34.2 |  35.4 |  39.4 |
| 23215060 |     960 | 32.7978 | 1.77501 |  27   | 31.6  |  32.8 |  34   |  37.4 |
| 25025002 |    7701 | 34.3217 | 2.06657 |  23   | 33    |  34.2 |  35.6 |  44   |
| 25025090 |    8486 | 33.5555 | 1.8415  |  26.4 | 32.4  |  33.6 |  34.8 |  40   |
| 25025250 |   11758 | 33.787  | 2.07519 |  26.6 | 32.4  |  34   |  35   |  42.6 |
| 25025300 |   10066 | 34.5617 | 2.3698  |  25.2 | 32.8  |  34.6 |  36.2 |  41.8 |
| 25025330 |    7606 | 33.2243 | 2.0554  |  23.2 | 31.8  |  33   |  34.6 |  41.6 |
| 28015030 |    1127 | 34.5657 | 1.85704 |  26.3 | 33.4  |  34.6 |  35.8 |  40.4 |
| 28015070 |   12645 | 33.7017 | 2.18347 |  23.8 | 32.2  |  33.6 |  35.2 |  42.2 |
| 28025020 |   12966 | 32.6602 | 2.08594 |  24.6 | 31.3  |  32.7 |  34.2 |  39.7 |
| 28025040 |    2613 | 29.7907 | 1.74453 |  22.4 | 28.6  |  30   |  31   |  39.2 |
| 28025070 |   13398 | 34.4325 | 2.35604 |  24.1 | 32.8  |  34.4 |  36.2 |  42.8 |
| 28025080 |    7076 | 33.5969 | 2.05285 |  26.4 | 32.2  |  33.6 |  35   |  40   |
| 28025090 |   12953 | 34.3336 | 2.09333 |  23.8 | 33    |  34.4 |  35.8 |  42.3 |
| 28025502 |   11456 | 34.6493 | 2.18198 |  24.8 | 33.2  |  34.7 |  36.2 |  41.8 |
| 28035010 |    8442 | 35.0506 | 2.25909 |  25   | 33.6  |  35.2 |  36.6 |  42.4 |
| 28035020 |   12136 | 34.7338 | 2.21035 |  25.4 | 33.2  |  34.8 |  36.4 |  41.8 |
| 28035040 |    9424 | 36.1116 | 2.03179 |  26   | 35    |  36.4 |  37.4 |  42.4 |
| 28035070 |      42 | 37.1095 | 1.26738 |  34   | 36.6  |  37.4 |  38   |  39.2 |
| 28045020 |    1050 | 33.8226 | 2.13222 |  27.2 | 32.25 |  33.8 |  35.4 |  39.2 |
| 28045040 |     784 | 34.5605 | 2.25236 |  26   | 33    |  34.6 |  36   |  41.8 |
| 29065010 |     893 | 33.5259 | 1.58034 |  29.4 | 32.4  |  33.6 |  34.6 |  37.2 |
| 29065020 |    9406 | 34.1372 | 1.63127 |  26   | 33    |  34.2 |  35.2 |  39.8 |
| 29065030 |   10537 | 33.3129 | 1.4911  |  24.8 | 32.4  |  33.4 |  34.2 |  38.6 |

</div>

### Method 1 - Outliers processing using the interquartile range IQR (q1 = 0.25, q3 = 0.75)

Outliers parameters:
* q1: quartile 0.25
* q3: quartile 0.75
* IQR: interquartile range (q3-q1)
* OlLowerLim: outlier bottom limit (q1-1.5*IQR)
* OlUpperLim: outlier top limit (q3+1.5*IQR)
* OlMinVal: minimum outlier value founded
* OlMaxVal: maximum outlier value founded
* OlCount: # outliers founded
* CapLowerLim: capped lower limit for outliers replacement (mean() - 3 * std())
* CapUpperLim: capped upper limit for outliers replacement (mean() + 3 * std())


<div align="center">

|          |    q1 |   q3 |   IQR |   OlLowerLim |   OlUpperLim |   OlMinVal |   OlMaxVal |   OlCount |   CapLowerLim |   CapUpperLim |
|---------:|------:|-----:|------:|-------------:|-------------:|-----------:|-----------:|----------:|--------------:|--------------:|
| 15015020 | 32.2  | 34.2 |  2    |       35.2   |       37.2   |       25.4 |       38.4 |       132 |       28.605  |       37.5409 |
| 15065040 | 33    | 35.4 |  2.4  |       36.6   |       39     |       25.1 |       39.4 |        39 |       28.5665 |       39.594  |
| 23215060 | 31.6  | 34   |  2.4  |       35.2   |       37.6   |       27   |       28   |         3 |       27.4728 |       38.1228 |
| 25025002 | 33    | 35.6 |  2.6  |       36.9   |       39.5   |       23   |       44   |       132 |       28.122  |       40.5214 |
| 25025090 | 32.4  | 34.8 |  2.4  |       36     |       38.4   |       26.4 |       40   |       127 |       28.031  |       39.08   |
| 25025250 | 32.4  | 35   |  2.6  |       36.3   |       38.9   |       26.6 |       42.6 |       184 |       27.5614 |       40.0125 |
| 25025300 | 32.8  | 36.2 |  3.4  |       37.9   |       41.3   |       25.2 |       41.8 |        22 |       27.4523 |       41.6711 |
| 25025330 | 31.8  | 34.6 |  2.8  |       36     |       38.8   |       23.2 |       41.6 |        53 |       27.0581 |       39.3905 |
| 28015030 | 33.4  | 35.8 |  2.4  |       37     |       39.4   |       26.3 |       40.4 |        14 |       28.9945 |       40.1368 |
| 28015070 | 32.2  | 35.2 |  3    |       36.7   |       39.7   |       23.8 |       42.2 |       103 |       27.1513 |       40.2521 |
| 28025020 | 31.3  | 34.2 |  2.9  |       35.65  |       38.55  |       24.6 |       39.7 |        86 |       26.4024 |       38.918  |
| 28025040 | 28.6  | 31   |  2.4  |       32.2   |       34.6   |       22.4 |       39.2 |        26 |       24.5571 |       35.0243 |
| 28025070 | 32.8  | 36.2 |  3.4  |       37.9   |       41.3   |       24.1 |       42.8 |        57 |       27.3644 |       41.5006 |
| 28025080 | 32.2  | 35   |  2.8  |       36.4   |       39.2   |       26.4 |       40   |        53 |       27.4383 |       39.7554 |
| 28025090 | 33    | 35.8 |  2.8  |       37.2   |       40     |       23.8 |       42.3 |       134 |       28.0536 |       40.6136 |
| 28025502 | 33.2  | 36.2 |  3    |       37.7   |       40.7   |       24.8 |       41.8 |        82 |       28.1034 |       41.1952 |
| 28035010 | 33.6  | 36.6 |  3    |       38.1   |       41.1   |       25   |       42.4 |        88 |       28.2733 |       41.8279 |
| 28035020 | 33.2  | 36.4 |  3.2  |       38     |       41.2   |       25.4 |       41.8 |        73 |       28.1028 |       41.3649 |
| 28035040 | 35    | 37.4 |  2.4  |       38.6   |       41     |       26   |       42.4 |       286 |       30.0162 |       42.2069 |
| 28035070 | 36.6  | 38   |  1.4  |       38.7   |       40.1   |       34   |       34.4 |         2 |       33.3074 |       40.9117 |
| 28045020 | 32.25 | 35.4 |  3.15 |       36.975 |       40.125 |       27.2 |       27.2 |         1 |       27.4259 |       40.2192 |
| 28045040 | 33    | 36   |  3    |       37.5   |       40.5   |       26   |       41.8 |         6 |       27.8034 |       41.3176 |
| 29065010 | 32.4  | 34.6 |  2.2  |       35.7   |       37.9   |      nan   |      nan   |         0 |       28.7848 |       38.2669 |
| 29065020 | 33    | 35.2 |  2.2  |       36.3   |       38.5   |       26   |       39.8 |        81 |       29.2434 |       39.031  |
| 29065030 | 32.4  | 34.2 |  1.8  |       35.1   |       36.9   |       24.8 |       38.6 |       217 |       28.8396 |       37.7862 |

</div>


![R.LTWB](Outlier_IQR_Pivot_TMX_CON.csv.png)

#### Identified and cleaning tables for 2001 IQR outliers founded
* Outliers identified file: [Outlier_IQR_Pivot_TMX_CON.csv](../../.datasets/IDEAM_Outlier/Outlier_IQR_Pivot_TMX_CON.csv)
* Outliers dropped file: [Outlier_IQR_Drop_Pivot_TMX_CON.csv](../../.datasets/IDEAM_Outlier/Outlier_IQR_Drop_Pivot_TMX_CON.csv)
* Outliers capped file: [Outlier_IQR_Cap_Pivot_TMX_CON.csv](../../.datasets/IDEAM_Outlier/Outlier_IQR_Cap_Pivot_TMX_CON.csv)
* Outliers imputed file: [Outlier_IQR_Impute_Pivot_TMX_CON.csv](../../.datasets/IDEAM_Outlier/Outlier_IQR_Impute_Pivot_TMX_CON.csv)

> The _drop file_ contains the database values without the outliers identified.
>
> The _capped file_ contains the database values and the outliers has been replaced with the lower or upper capped value calculated. Lower outliers could be replaced with negative values because the limit is defined with (mean() - cap_multiplier * std()). In some cases like _temperature analysis_, the upper outliers values could be replaced with values over the original values and you can try to fix this issue changing the parameter _cap_multiplier_ that defines the stripe values range.
>
> The imputation method replace each outlier value with the mean value that contains the original outliers values.


#### Statistical values for the capped and imputed file

<div align="center">

General statistics table - Capped file

</div>


<div align="center">

|          |   count |    mean |     std |     min |   25% |   50% |   75% |     max |
|---------:|--------:|--------:|--------:|--------:|------:|------:|------:|--------:|
| 15015020 |    8859 | 33.074  | 1.48386 | 28.605  | 32.2  |  33.2 |  34.2 | 37.5409 |
| 15065040 |    3465 | 34.0836 | 1.82566 | 28.5665 | 33    |  34.2 |  35.4 | 39.594  |
| 23215060 |     960 | 32.7972 | 1.7766  | 27.4728 | 31.6  |  32.8 |  34   | 37.4    |
| 25025002 |    7701 | 34.3227 | 2.07073 | 28.122  | 33    |  34.2 |  35.6 | 40.5214 |
| 25025090 |    8486 | 33.5579 | 1.84603 | 28.031  | 32.4  |  33.6 |  34.8 | 39.08   |
| 25025250 |   11758 | 33.7887 | 2.08702 | 27.5614 | 32.4  |  34   |  35   | 40.0125 |
| 25025300 |   10066 | 34.5631 | 2.36544 | 27.4523 | 32.8  |  34.6 |  36.2 | 41.6711 |
| 25025330 |    7606 | 33.2241 | 2.04537 | 27.0581 | 31.8  |  33   |  34.6 | 39.3905 |
| 28015030 |    1127 | 34.5707 | 1.84026 | 28.9945 | 33.4  |  34.6 |  35.8 | 40.1368 |
| 28015070 |   12645 | 33.703  | 2.17612 | 27.1513 | 32.2  |  33.6 |  35.2 | 40.2521 |
| 28025020 |   12966 | 32.6618 | 2.07969 | 26.4024 | 31.3  |  32.7 |  34.2 | 38.918  |
| 28025040 |    2613 | 29.7904 | 1.7332  | 24.5571 | 28.6  |  30   |  31   | 35.0243 |
| 28025070 |   13398 | 34.4341 | 2.34959 | 27.3644 | 32.8  |  34.4 |  36.2 | 41.5006 |
| 28025080 |    7076 | 33.5974 | 2.05679 | 27.4383 | 32.2  |  33.6 |  35   | 39.7554 |
| 28025090 |   12953 | 34.3351 | 2.09164 | 28.0536 | 33    |  34.4 |  35.8 | 40.6136 |
| 28025502 |   11456 | 34.653  | 2.1683  | 28.1034 | 33.2  |  34.7 |  36.2 | 41.1952 |
| 28035010 |    8442 | 35.0543 | 2.24881 | 28.2733 | 33.6  |  35.2 |  36.6 | 41.8279 |
| 28035020 |   12136 | 34.7374 | 2.19765 | 28.1028 | 33.2  |  34.8 |  36.4 | 41.3649 |
| 28035040 |    9424 | 36.1077 | 2.05495 | 30.0162 | 35    |  36.4 |  37.4 | 42.2069 |
| 28035070 |      42 | 37.067  | 1.37648 | 33.3074 | 36.6  |  37.4 |  38   | 39.2    |
| 28045020 |    1050 | 33.8228 | 2.13156 | 27.4259 | 32.25 |  33.8 |  35.4 | 39.2    |
| 28045040 |     784 | 34.565  | 2.23299 | 27.8034 | 33    |  34.6 |  36   | 41.3176 |
| 29065010 |     893 | 33.5259 | 1.58034 | 29.4    | 32.4  |  33.6 |  34.6 | 37.2    |
| 29065020 |    9406 | 34.1407 | 1.61885 | 29.2434 | 33    |  34.2 |  35.2 | 39.031  |
| 29065030 |   10537 | 33.3189 | 1.46964 | 28.8396 | 32.4  |  33.4 |  34.2 | 37.7862 |

</div>


<div align="center">

General statistics table - Imputed file

</div>


<div align="center">

|          |   count |    mean |     std |   min |   25% |     50% |   75% |   max |
|---------:|--------:|--------:|--------:|------:|------:|--------:|------:|------:|
| 15015020 |    8859 | 33.1265 | 1.37895 |  29.4 | 32.2  | 33.2    |  34.2 |  37.2 |
| 15065040 |    3465 | 34.1393 | 1.72838 |  29.6 | 33    | 34.2    |  35.4 |  39   |
| 23215060 |     960 | 32.8138 | 1.75138 |  28.2 | 31.6  | 32.8    |  34   |  37.4 |
| 25025002 |    7701 | 34.3468 | 1.90483 |  29.2 | 33    | 34.3217 |  35.6 |  39.4 |
| 25025090 |    8486 | 33.5546 | 1.71785 |  28.8 | 32.4  | 33.6    |  34.8 |  38.2 |
| 25025250 |   11758 | 33.7549 | 1.93599 |  28.6 | 32.4  | 34      |  35   |  38.8 |
| 25025300 |   10066 | 34.5744 | 2.34194 |  27.8 | 32.8  | 34.6    |  36.2 |  41.2 |
| 25025330 |    7606 | 33.199  | 1.97938 |  27.6 | 31.8  | 33      |  34.4 |  38.8 |
| 28015030 |    1127 | 34.6202 | 1.73139 |  29.8 | 33.5  | 34.6    |  35.8 |  39.3 |
| 28015070 |   12645 | 33.7066 | 2.09426 |  27.8 | 32.2  | 33.6    |  35.2 |  39.6 |
| 28025020 |   12966 | 32.6908 | 2.01604 |  27   | 31.4  | 32.7    |  34.2 |  38.5 |
| 28025040 |    2613 | 29.8064 | 1.6526  |  25.2 | 28.8  | 30      |  31   |  34.4 |
| 28025070 |   13398 | 34.4525 | 2.30382 |  27.8 | 32.8  | 34.4    |  36.2 |  41.2 |
| 28025080 |    7076 | 33.5982 | 1.98652 |  28.2 | 32.2  | 33.6    |  35   |  39   |
| 28025090 |   12953 | 34.3583 | 1.99156 |  29   | 33    | 34.4    |  35.8 |  39.8 |
| 28025502 |   11456 | 34.6896 | 2.09599 |  28.8 | 33.3  | 34.7    |  36.2 |  40.7 |
| 28035010 |    8442 | 35.0961 | 2.13922 |  29.2 | 33.6  | 35.2    |  36.6 |  41   |
| 28035020 |   12136 | 34.7686 | 2.13634 |  28.6 | 33.35 | 34.8    |  36.3 |  41   |
| 28035040 |    9424 | 36.2371 | 1.75483 |  31.6 | 35.2  | 36.4    |  37.4 |  41   |
| 28035070 |      42 | 37.2481 | 1.08245 |  34.6 | 36.85 | 37.4    |  38   |  39.2 |
| 28045020 |    1050 | 33.8289 | 2.12238 |  27.8 | 32.4  | 33.8    |  35.4 |  39.2 |
| 28045040 |     784 | 34.5994 | 2.15288 |  28.8 | 33.2  | 34.6    |  36   |  40.2 |
| 29065010 |     893 | 33.5259 | 1.58034 |  29.4 | 32.4  | 33.6    |  34.6 |  37.2 |
| 29065020 |    9406 | 34.1495 | 1.55379 |  29.8 | 33    | 34.2    |  35.2 |  38.4 |
| 29065030 |   10537 | 33.3838 | 1.32012 |  29.8 | 32.5  | 33.4    |  34.2 |  36.8 |

</div>

