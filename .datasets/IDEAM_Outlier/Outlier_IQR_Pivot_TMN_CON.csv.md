## Outliers detection and processing

* Processed file: [D:/R.LTWB/.datasets/IDEAM_EDA/Pivot_TMN_CON.csv](../IDEAM_EDA/Pivot_TMN_CON.csv)
* Execution date: 2022-11-03 10:19:05.045572
* Python version: 3.10.5 (tags/v3.10.5:f377153, Jun  6 2022, 16:14:13) [MSC v.1929 64 bit (AMD64)]
* Python path: ['D:\\R.LTWB\\.src', 'D:\\R.LTWB', 'D:\\R.GISPython.wiki', 'D:\\R.GISPython', 'D:\\R.HydroTools']
* matplotlib version: 3.6.0
* pandas version: 1.4.3
* Print table sample: True
* Instructions & script: https://github.com/rcfdtools/R.LTWB/tree/main/Section03/Outlier
* License: https://github.com/rcfdtools/R.LTWB/blob/main/LICENSE.md
* Credits: r.cfdtools@gmail.com


### General dataframe information with 15341 IDEAM records for 25 stations

Dataframe records head sample

| Fecha               |   15015020 |   15065040 |   23215060 |   25025002 |   25025090 |   25025250 |   25025300 |   25025330 |   28015030 |   28015070 |   28025020 |   28025040 |   28025070 |   28025080 |   28025090 |   28025502 |   28035010 |   28035020 |   28035040 |   28035070 |   28045020 |   28045040 |   29065010 |   29065020 |   29065030 |
|:--------------------|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|
| 1980-01-01 00:00:00 |       23.2 |        nan |        nan |        nan |       24.2 |        nan |        nan |        nan |      nan   |       23   |        nan |       20.2 |       22.8 |       21.8 |        nan |        nan |      nan   |       19.4 |        nan |        nan |        nan |        nan |       21.4 |        nan |       21.4 |
| 1980-01-02 00:00:00 |       22.4 |        nan |        nan |        nan |       24.2 |        nan |        nan |        nan |       23.3 |       23.5 |        nan |       21   |       23.4 |       21.6 |        nan |         24 |      nan   |       19.6 |        nan |        nan |        nan |        nan |      nan   |        nan |       21.8 |
| 1980-01-03 00:00:00 |       20.8 |        nan |        nan |        nan |       24.6 |        nan |        nan |        nan |       24   |      nan   |        nan |       19.8 |       23.4 |       21.4 |        nan |        nan |       22.4 |       19   |        nan |        nan |        nan |        nan |      nan   |        nan |      nan   |

Dataframe records tail sample

| Fecha               |   15015020 |   15065040 |   23215060 |   25025002 |   25025090 |   25025250 |   25025300 |   25025330 |   28015030 |   28015070 |   28025020 |   28025040 |   28025070 |   28025080 |   28025090 |   28025502 |   28035010 |   28035020 |   28035040 |   28035070 |   28045020 |   28045040 |   29065010 |   29065020 |   29065030 |
|:--------------------|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|-----------:|
| 2021-12-29 00:00:00 |        nan |        nan |        nan |       21.8 |       23   |       24.8 |       23.2 |         23 |        nan |       21.8 |       18.8 |        nan |       23   |        nan |       21.2 |        nan |       22.6 |       22.8 |       25.4 |        nan |        nan |        nan |        nan |       25   |        nan |
| 2021-12-30 00:00:00 |        nan |        nan |        nan |       22.4 |       24   |       24.4 |       22.6 |         24 |        nan |       21   |       18.2 |        nan |       22.8 |        nan |       20   |        nan |       20.8 |       22.4 |       24.4 |        nan |        nan |        nan |        nan |       24.8 |        nan |
| 2021-12-31 00:00:00 |        nan |        nan |        nan |       20.4 |       21.4 |       24.2 |       22   |        nan |        nan |       20.2 |       20.2 |        nan |       22   |        nan |       21.2 |        nan |       20.8 |       22   |       24   |        nan |        nan |        nan |        nan |       25.4 |        nan |

Datatypes for station and nulls values in the dataset

<div align="center">

|       | 15015020   | 15065040   | 23215060   | 25025002   | 25025090   | 25025250   | 25025300   | 25025330   | 28015030   | 28015070   | 28025020   | 28025040   | 28025070   | 28025080   | 28025090   | 28025502   | 28035010   | 28035020   | 28035040   | 28035070   | 28045020   | 28045040   | 29065010   | 29065020   | 29065030   |
|:------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|:-----------|
| Dtype | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    | float64    |
| Nulls | 5377       | 10392      | 14093      | 4608       | 5567       | 3001       | 3648       | 6066       | 13937      | 2866       | 1889       | 12110      | 1523       | 7705       | 3474       | 3103       | 4784       | 3517       | 1936       | 15299      | 14289      | 14067      | 14278      | 2358       | 3815       |

</div>


<div align="center">

General statistics table

</div>


<div align="center">

|          |   count |    mean |     std |   min |   25% |   50% |   75% |   max |
|---------:|--------:|--------:|--------:|------:|------:|------:|------:|------:|
| 15015020 |    9964 | 22.1888 | 1.60856 |  16   |  21.2 |  22.4 |  23.2 |  26.8 |
| 15065040 |    4949 | 22.9664 | 1.75384 |  12.4 |  22.2 |  23.2 |  24.2 |  27.8 |
| 23215060 |    1248 | 23.6837 | 1.20744 |  16.6 |  23   |  23.8 |  24.6 |  26.8 |
| 25025002 |   10733 | 22.9428 | 1.56303 |  16.8 |  22   |  23   |  24   |  27.2 |
| 25025090 |    9774 | 23.5651 | 1.53376 |  17   |  22.6 |  23.6 |  24.8 |  28   |
| 25025250 |   12340 | 22.3963 | 1.63717 |  17   |  21.2 |  22.4 |  23.8 |  27.1 |
| 25025300 |   11693 | 22.9902 | 1.75271 |  15.4 |  22   |  23.2 |  24.2 |  27.8 |
| 25025330 |    9275 | 22.7791 | 1.6933  |  13.1 |  21.8 |  23   |  24   |  28.6 |
| 28015030 |    1404 | 22.9291 | 1.32774 |  10   |  22.2 |  23   |  23.8 |  26.8 |
| 28015070 |   12475 | 22.34   | 1.33165 |  15.4 |  21.5 |  22.5 |  23.2 |  26.2 |
| 28025020 |   13452 | 20.547  | 1.73534 |  12   |  19.6 |  20.8 |  21.8 |  26   |
| 28025040 |    3231 | 18.674  | 2.11514 |   8.4 |  18   |  19.2 |  20   |  27.4 |
| 28025070 |   13818 | 23.7666 | 1.54724 |  17.4 |  22.8 |  23.8 |  25   |  28.6 |
| 28025080 |    7636 | 21.7751 | 1.87894 |  15.2 |  20.4 |  22.2 |  23.2 |  27   |
| 28025090 |   11867 | 22.4272 | 1.67337 |  15   |  21.6 |  22.8 |  23.6 |  27.4 |
| 28025502 |   12238 | 23.8861 | 1.27915 |  18.4 |  23   |  23.8 |  24.8 |  28.6 |
| 28035010 |   10557 | 23.3278 | 1.49337 |  13.4 |  22.6 |  23.4 |  24.2 |  28.8 |
| 28035020 |   11824 | 22.8005 | 1.82844 |  15.8 |  21.8 |  23   |  24   |  28.6 |
| 28035040 |   13405 | 24.269  | 1.23846 |  17.2 |  23.4 |  24.2 |  25   |  28.6 |
| 28035070 |      42 | 22.0286 | 1.01844 |  20.6 |  21.4 |  21.8 |  22.6 |  25.6 |
| 28045020 |    1052 | 21.2974 | 1.79272 |  14.6 |  20.2 |  21.6 |  22.6 |  26.4 |
| 28045040 |    1274 | 23.128  | 1.26701 |  14.6 |  22.4 |  23.2 |  24   |  26.6 |
| 29065010 |    1063 | 21.3162 | 1.60256 |  15.2 |  20.4 |  21.4 |  22.4 |  25.2 |
| 29065020 |   12983 | 22.327  | 1.85521 |  14.2 |  21.2 |  22.6 |  23.6 |  27.4 |
| 29065030 |   11526 | 21.8104 | 1.55983 |  14   |  20.8 |  22   |  23   |  27   |

</div>

### Method 1 - Outliers processing using the interquartile range IQR (q1 = 0.25, q3 = 0.75)

Outliers parameters:
* q1: quartile 0.25
* q3: quartile 0.75
* IQR: interquartile range (q3-q1)
* OlLowerLim: outlier bottom limit (q1-1.5*IQR)
* OlUpperLim: outlier top limit (q3+1.5*IQR)
* OlMinVal: minimum outlier value founded
* OlMaxVal: maximum outlier value founded
* OlCount: # outliers founded
* CapLowerLim: capped lower limit for outliers replacement (mean() - cap_multiplier * std())
* CapUpperLim: capped upper limit for outliers replacement (mean() + cap_multiplier * std())


<div align="center">

|          |   q1 |   q3 |   IQR |   OlLowerLim |   OlUpperLim |   OlMinVal |   OlMaxVal |   OlCount |   CapLowerLim |   CapUpperLim |
|---------:|-----:|-----:|------:|-------------:|-------------:|-----------:|-----------:|----------:|--------------:|--------------:|
| 15015020 | 21.2 | 23.2 |   2   |        24.2  |        26.2  |       16   |       26.8 |       123 |       17.3631 |       27.0145 |
| 15065040 | 22.2 | 24.2 |   2   |        25.2  |        27.2  |       12.4 |       27.8 |       221 |       17.7049 |       28.2279 |
| 23215060 | 23   | 24.6 |   1.6 |        25.4  |        27    |       16.6 |       20.4 |        18 |       20.0613 |       27.306  |
| 25025002 | 22   | 24   |   2   |        25    |        27    |       16.8 |       27.2 |       141 |       18.2537 |       27.6319 |
| 25025090 | 22.6 | 24.8 |   2.2 |        25.9  |        28.1  |       17   |       19.2 |       101 |       18.9639 |       28.1664 |
| 25025250 | 21.2 | 23.8 |   2.6 |        25.1  |        27.7  |       17   |       17.2 |         5 |       17.4848 |       27.3078 |
| 25025300 | 22   | 24.2 |   2.2 |        25.3  |        27.5  |       15.4 |       27.8 |       239 |       17.7321 |       28.2483 |
| 25025330 | 21.8 | 24   |   2.2 |        25.1  |        27.3  |       13.1 |       28.6 |       187 |       17.6992 |       27.859  |
| 28015030 | 22.2 | 23.8 |   1.6 |        24.6  |        26.2  |       10   |       26.8 |        27 |       18.9458 |       26.9123 |
| 28015070 | 21.5 | 23.2 |   1.7 |        24.05 |        25.75 |       15.4 |       26.2 |       136 |       18.345  |       26.3349 |
| 28025020 | 19.6 | 21.8 |   2.2 |        22.9  |        25.1  |       12   |       26   |       262 |       15.341  |       25.753  |
| 28025040 | 18   | 20   |   2   |        21    |        23    |        8.4 |       27.4 |       221 |       12.3286 |       25.0194 |
| 28025070 | 22.8 | 25   |   2.2 |        26.1  |        28.3  |       17.4 |       28.6 |       125 |       19.1249 |       28.4084 |
| 28025080 | 20.4 | 23.2 |   2.8 |        24.6  |        27.4  |       15.2 |       16   |        34 |       16.1383 |       27.4119 |
| 28025090 | 21.6 | 23.6 |   2   |        24.6  |        26.6  |       15   |       27.4 |       385 |       17.4071 |       27.4473 |
| 28025502 | 23   | 24.8 |   1.8 |        25.7  |        27.5  |       18.4 |       28.6 |        56 |       20.0487 |       27.7235 |
| 28035010 | 22.6 | 24.2 |   1.6 |        25    |        26.6  |       13.4 |       28.8 |       510 |       18.8477 |       27.8079 |
| 28035020 | 21.8 | 24   |   2.2 |        25.1  |        27.3  |       15.8 |       28.6 |       358 |       17.3152 |       28.2858 |
| 28035040 | 23.4 | 25   |   1.6 |        25.8  |        27.4  |       17.2 |       28.6 |       158 |       20.5536 |       27.9844 |
| 28035070 | 21.4 | 22.6 |   1.2 |        23.2  |        24.4  |       25.6 |       25.6 |         1 |       18.9733 |       25.0839 |
| 28045020 | 20.2 | 22.6 |   2.4 |        23.8  |        26.2  |       14.6 |       26.4 |        14 |       15.9193 |       26.6756 |
| 28045040 | 22.4 | 24   |   1.6 |        24.8  |        26.4  |       14.6 |       26.6 |        14 |       19.327  |       26.929  |
| 29065010 | 20.4 | 22.4 |   2   |        23.4  |        25.4  |       15.2 |       17.2 |        17 |       16.5085 |       26.1239 |
| 29065020 | 21.2 | 23.6 |   2.4 |        24.8  |        27.2  |       14.2 |       27.4 |       214 |       16.7614 |       27.8927 |
| 29065030 | 20.8 | 23   |   2.2 |        24.1  |        26.3  |       14   |       27   |        62 |       17.1309 |       26.4899 |

</div>


![R.LTWB](Outlier_IQR_Pivot_TMN_CON.csv.png)

Identified and cleaning tables for 3629 IQR outliers founded
* Identified outliers table: [Outlier_IQR_Drop_Pivot_TMN_CON.csv](../../.datasets/IDEAM_Outlier/Outlier_IQR_Drop_Pivot_TMN_CON.csv)
* Outliers drop file: [Outlier_IQR_Drop_Pivot_TMN_CON.csv](../../.datasets/IDEAM_Outlier/Outlier_IQR_Drop_Pivot_TMN_CON.csv)

> The _drop file_ contains the database values without the outliers identified.

> The _capped file_ contains the database values an the outliers has been replaced with the lower or upper capped value calculated. Lower outliers can be replaced with negative values because the limit is defined with (mean() - cap_multiplier * std())
